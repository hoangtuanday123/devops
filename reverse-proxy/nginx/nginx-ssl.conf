#XJOB
server {
        listen 80;
        server_name xjob.connexus.vn;


        location /.well-known/acme-challenge/ {
                root /var/www/certbot;
        }

        location / {
                return 301 https://$host$request_uri;
        }
}

server {
        listen 443 ssl;
        server_name xjob.connexus.vn;
        resolver 127.0.0.11;

        ssl_certificate /etc/letsencrypt/live/xjob.connexus.vn-0001/fullchain.pem;
        ssl_certificate_key /etc/letsencrypt/live/xjob.connexus.vn-0001/privkey.pem;
        location / {
                set $xjob_host "xjob_web";
                proxy_pass http://$xjob_host:8081;
                proxy_set_header Host $host;
                proxy_set_header X-Forwarded-Proto $scheme;
                proxy_set_header X-Real-IP $remote_addr;
                proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        }
}

#XOEE
server {
        listen 80;
        server_name xoee.connexus.vn;


        location /.well-known/acme-challenge/ {
                root /var/www/certbot;
        }

        location / {
                return 301 https://$host$request_uri;
        }
}

server {
        listen 443 ssl;
        server_name xoee.connexus.vn;
        resolver 127.0.0.11;

        ssl_certificate /etc/letsencrypt/live/xoee.connexus.vn/fullchain.pem;
        ssl_certificate_key /etc/letsencrypt/live/xoee.connexus.vn/privkey.pem;

        location / {
                set $tcexam_host "tcexam_web";
                proxy_pass http://$tcexam_host:80;
                proxy_set_header Host $host;
                proxy_set_header X-Forwarded-Proto $scheme;
                proxy_set_header X-Real-IP $remote_addr;
                proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        }

}
#XIP_BACKEND
server {
        listen 80;
        server_name asap-api.connexus.vn;

        location /.well-known/acme-challenge/ {
                root /var/www/certbot;
        }

        location / {
                return 301 https://$host$request_uri;
        }
}

server {
        listen 443 ssl;
        server_name asap-api.connexus.vn;
        resolver 127.0.0.11;
        client_max_body_size 8M;

        ssl_certificate /etc/letsencrypt/live/asap-api.connexus.vn/fullchain.pem;
        ssl_certificate_key /etc/letsencrypt/live/asap-api.connexus.vn/privkey.pem;

        location / {
                set $xip_backend_host "xip_backend";
                proxy_pass http://$xip_backend_host:8080;
                proxy_set_header Host $host;
                proxy_set_header X-Forwarded-Proto $scheme;
                proxy_set_header X-Real-IP $remote_addr;
                proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        }

}

#XIP_FRONTEND
server {
        listen 80;
        server_name asap.connexus.vn;


        location /.well-known/acme-challenge/ {
                root /var/www/certbot;
        }

        location / {
                return 301 https://$host$request_uri;
        }
}

server {
        listen 443 ssl;
        server_name asap.connexus.vn;
        resolver 127.0.0.11;

        ssl_certificate /etc/letsencrypt/live/asap.connexus.vn/fullchain.pem;
        ssl_certificate_key /etc/letsencrypt/live/asap.connexus.vn/privkey.pem;

        location / {
                set $xip_frontend_host "xip_frontend";
                proxy_pass http://$xip_frontend_host:8088;
                proxy_set_header Host $host;
                proxy_set_header X-Forwarded-Proto $scheme;
                proxy_set_header X-Real-IP $remote_addr;
                proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        }

}

#XHRM
server {
        listen 10.0.0.36:8082;
        server_name xhrm.connexus.vn;

        location / {
        root /var/www/html;
        index index.html index.htm;
    }
}
server {
        listen 10.0.0.36:8082;
        server_name xhrm.connexus.vn;
        resolver 127.0.0.11;

        location / {
                set $xhrm_web_host "xhrm_web";
                proxy_pass http://$xhrm_web_host:8082;
                proxy_set_header Host $host;
                proxy_set_header X-Forwarded-Proto $scheme;
                proxy_set_header X-Real-IP $remote_addr;
                proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        }

}